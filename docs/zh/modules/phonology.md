# 音系

管理语言的语音系统，包含 4 个子页面：音素表、罗马音映射、音位配列和音位变体。

## 音素表

**导航**：点击左侧 `音系` → `音素表`

这是创造语言最根本的第一步：决定你的语言使用哪些语音。

### 交互式 IPA 图表

- **辅音表**：13 个发音部位 × 13 种发音方式的完整矩阵，点击即可选择/取消音素
- **元音梯形图**：标准 IPA 元音梯形，直观展示元音的舌位高低与前后
- **非肺音辅音**：内爆音、挤喉音、搭嘴音独立区域
- **音频播放**：点击任意音素即时播放其 IPA 标准发音（内置 329 个音素音频，完全离线运行）

### 预设系统

提供 12 种真实语言风格预设，点击预设名称即可一键加载音素集和音节结构：

| 预设 | 特点 |
|------|------|
| 日语风 | (C)V 音节，无辅音尾 |
| 阿拉伯语风 | 丰富的咽音/小舌音 |
| 斯拉夫语风 | 复杂辅音簇 |
| 芬兰语风 | 元音和谐 |
| 夏威夷语风 | 极少辅音，CV 为主 |
| 纳瓦特尔语风 | 塞擦音丰富 |
| 普通话风 | 送气对立 + 声调 |
| 印地语风 | 卷舌 + 送气对立 |
| 斯瓦希里语风 | 前鼻化辅音 |
| 拉丁语风 | 经典印欧语系 |
| 格鲁吉亚语风 | 挤喉音 |
| 精灵语风 | 流音丰富，柔和 |

:::warning
加载预设会覆盖当前的音素和音节结构配置，请注意备份。
:::

### 音素表警告

应用会自动检测音系中的不平衡并给出警告提示，例如：
- 缺少清浊对立（有 /p/ 但没有 /b/）
- 元音或辅音数量过少
- 发音部位分布不均匀

### 实用建议

- **辅音数量**：15~25 个是常见范围
- **元音数量**：5~7 个最常见（a, e, i, o, u 是经典五元音系统）
- **注意对称性**：如果有 /p/（双唇清塞音），通常也该有 /b/（双唇浊塞音）

## 罗马音映射

**导航**：`音系` → `罗马音`

正字法决定了你的语言"写出来"是什么样子。

### 多映射表

支持创建多套映射表（如"标准拼写""学术转写"），可设置默认映射表。

### 规则定义

每条规则有「输入」→「输出音素」，可附带上下文环境：
- 输入：罗马字（如 `sh`）
- 输出：IPA 音素（如 `/ʃ/`）

### 最长匹配

自动按输入长度降序排序，贪心优先匹配长序列。例如有 `sh → ʃ` 和 `s → s` 两条规则时，`sh` 会优先匹配为 `/ʃ/`，而不会拆分为 `s` + `h`。

### 音素表联动

点击音素表中的音素可快速插入到编辑字段，无需手动输入 IPA 字符。

:::tip
映射表定义后，在词典中输入拼写时会**自动生成 IPA**。
:::

## 音位配列

**导航**：`音系` → `音位配列`

音节结构决定了你的语言中什么样的音素组合是合法的。

### 音素类宏

自定义宏作为音节模板中的占位符：

| 宏 | 示例 |
|----|------|
| `C` | 所有辅音：`p, t, k, s, m, n, l` |
| `V` | 所有元音：`a, e, i, o, u` |
| `N` | 鼻音：`m, n, ŋ` |

### 音节结构模板

使用大写字母宏和括号定义合法的音节结构：

- `CV` — 最简单，如日语：ka, mi, su
- `(C)V` — 允许无辅音开头：a, ka, mi
- `(C)V(C)` — 允许辅音尾：an, kat, su
- `(C)(C)V(C)(C)` — 允许复杂辅音簇：str, nd

### 高级规则

| 功能 | 说明 |
|------|------|
| 黑名单 | 正则表达式拒绝非法音节组合（如 `/^ng/` 禁止词首 ng-） |
| 元音和谐 | 将元音分两组，同一词内不允许混用 |
| 声调系统 | 定义声调类别（名称 + 标记符号） |

## 音位变体

**导航**：`音系` → `音位变体`

定义音素在特定上下文中的变体形式。

- **规则**：目标音素 → 替换音素，可设前置/后置上下文
- **优先级**：按 priority 降序依次应用，首个匹配即停止
- **宏引用**：上下文中可引用音素类宏（如 `V` 表示"任意元音后"）

:::tip
音位变体规则会在 IPA 自动生成时应用，影响词典中所有词条的自动 IPA。
:::
